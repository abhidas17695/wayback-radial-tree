{"version":3,"file":"radial-tree.esm.js","sources":["../src/js/index.js"],"sourcesContent":["/**\n * Radial Tree Library\n * \n * @param {DOMElement} element\n @ @param {Array} cdx_data: decoded CDX Query data retrieved by:\n  ``/web/timemap/json?url=example.com/&fl=timestamp:4,original&matchType=prefix\n    &filter=statuscode:200&filter=mimetype:text/html&collapse=urlkey\n    &collapse=timestamp:4&limit=100000``.\n * @param {Object} option\n * Option baseURL defines the target Wayback Machine server.\n * Option indicatorImg defines the graphic to display while loading data from\n * the Wayback Machine. If undefined, no loading graphic is displayed.\n */\nimport * as d3 from 'd3';\n\n\nexport function RadialTree(element, cdx_data, option){\n    var GlobYear = 0;\n    var baseURL = 'https://web.archive.org';\n    var indicatorImg;\n    // Use typeof check to allow empty string in baseURL value\n    if (typeof option.baseURL !== 'undefined') {\n        baseURL = option.baseURL;\n    }\n    if (option.indicatorImg) {\n        indicatorImg = option.indicatorImg;\n    }\n    if (!option.url) return;\n\n    Init(element);\n    GetData(option.url, cdx_data, function(success, err, allYears, yearData){\n        if(indicatorImg) {\n            element.querySelector(\".rt-indicator\").style.display = \"none\";\n        }\n        if (!success) return;\n\n        CreateYearButtons(element, option, allYears, yearData);\n    });\n\n    function Init(container){\n        var content = document.createElement(\"div\");\n        content.setAttribute(\"class\", \"rt-content\");\n        var divBtn = document.createElement(\"div\");\n        divBtn.setAttribute(\"class\", \"div-btn\");\n\n        var sequence = document.createElement(\"p\");\n        sequence.setAttribute(\"class\", \"sequence\");\n        var chart = document.createElement(\"div\");\n        chart.setAttribute(\"id\", \"chart\");\n        if(indicatorImg) {\n            var indicator = document.createElement(\"img\");\n            indicator.setAttribute(\"src\", indicatorImg);\n            indicator.setAttribute(\"class\", \"rt-indicator\");\n            chart.appendChild(indicator);\n        }\n        content.appendChild(divBtn);\n        content.appendChild(sequence);\n        content.appendChild(chart);\n        content.style.display = \"block\";\n\n        container.appendChild(content);\n    }\n\n    function GetData(url, response, cb){\n        var regexHTTP   = /http:\\/\\//;\n        var regexHTTPS  = /https:\\/\\//;\n        var regexLast   = /\\/$/;\n        url.replace(regexHTTP, \"\");\n        url.replace(regexHTTPS, \"\");\n        url.replace(regexLast, \"\");\n\n        if (response.length == 0) cb(true, []);\n\n        var yearUrl = [];\n        for(var i=1; i<response.length; i++) {\n            if (response[i][1].match(/jpg|pdf|png|form|gif/)) {\n                continue;\n            }\n            response[i][1] = response[i][1].trim().replace(\":80/\", \"/\");\n            if(response[i][0] in yearUrl) {\n                yearUrl[response[i][0]].push(response[i][1]);\n            } else {\n                yearUrl[response[i][0]] = [response[i][1]];\n            }\n        }\n        var ret = [];\n        for (var year in yearUrl) {\n            ret.push([year].concat(yearUrl[year]));\n        }\n        /** ret has the following format:\n          *  array(\n          *    array(2005, url1, url2, .... urlN),\n          *    ...\n          *  ) **/\n        var years = (function(){\n            for (var i=0; i<ret.length; i++) {\n                for (var j=1; j<ret[i].length; j++) {\n                    var url;\n                    if (ret[i][j].includes(\"http\")) {\n                        url = ret[i][j].substring(7);\n                    } else if (ret[i][j].includes(\"https\")) {\n                        url = ret[i][j].substring(8);\n                    }\n                    if (url.includes('//')) {\n                        url = url.split('//').join('/');\n                    }\n                    url = url.split('/').join('/');\n                    ret[i][j] = url;\n                }\n            }\n            return ret;\n        }());\n        var all_years = years.map(function(year) {\n            if(year.length > 1) {\n                return year[0];\n            }\n        });\n        cb(true, null, all_years, years);\n    }\n\n    function CreateYearButtons(element, option, allYears, yearData){\n        var divBtn = element.querySelector(\".div-btn\");\n        if (!element.querySelector(\".year-btn\")){\n            allYears.forEach(function(year, i){\n                var btn = document.createElement(\"button\");\n                btn.setAttribute(\"class\", \"year-btn\");\n                btn.setAttribute(\"id\", allYears[i]);\n                btn.innerHTML = allYears[i];\n                btn.onclick = function(evt){\n                    var target = evt.target;\n                    if (element.querySelector(\".active-btn\")) {\n                        element.querySelector(\".active-btn\").classList.remove(\"active-btn\");\n                    }\n                    target.classList.add(\"active-btn\");\n                    GlobYear = target.id;\n                    var num = allYears.indexOf(target.id);\n                    var text = MakeNewText(num, yearData);\n                    DrawChart(element, option, text);\n                };\n                divBtn.appendChild(btn);\n                if (i == allYears.length - 1) btn.click();\n            });\n        }\n    }\n\n    function DrawChart(element, option, text){\n        element.querySelector(\".sequence\").innerHTML    = \"\";\n        element.querySelector(\"#chart\").innerHTML       = \"\";\n        const width = element.querySelector('#chart').offsetWidth;\n        const height = width;\n        const radius = Math.min(width, height) / 2;\n        var colors = d3.scaleOrdinal(d3.schemeCategory20b);\n        var vis = d3.select(\"#chart\")\n            .append(\"svg:svg\")\n            .attr(\"width\", width)\n            .attr(\"height\", height)\n            .append(\"svg:g\")\n            .attr(\"id\", \"d3_container\")\n            .attr(\"transform\", \"translate(\" + width / 2 + \",\" + height / 2 + \")\");\n        var partition = d3.partition()\n            .size([2 * Math.PI, radius * radius]);\n        var arc = d3.arc()\n            .startAngle(function(d) { return d.x0; })\n            .endAngle(function(d) { return d.x1; })\n            .innerRadius(function(d) { return Math.sqrt(d.y0); })\n            .outerRadius(function(d) { return Math.sqrt(d.y1); });\n\n        var csv = d3.csvParseRows(text);\n        var json = BuildHierarchy(csv);\n        CreateVisualization(json);\n\n        function CreateVisualization(json) {\n            vis.append(\"svg:circle\")\n                .attr(\"r\", radius)\n                .style(\"opacity\", 0);\n            var root = d3.hierarchy(json)\n                .sum(function(d) { return d.size; })\n                .sort(function(a, b) { return b.value - a.value; });\n            var nodes = partition(root)\n                .descendants();\n            var path = vis.data([json])\n                .selectAll(\"path\")\n                .data(nodes)\n                .enter()\n                .append(\"svg:path\")\n                .attr(\"display\", function(d) { return d.depth ? null : \"none\"; })\n                .attr(\"d\", arc)\n                .attr(\"fill-rule\", \"evenodd\")\n                .style(\"fill\", function(d) {\n                    if (d.data.name == 'end') { return '#000000'; } else {\n                        return colors((d.children ? d : d.parent).data.name);\n                    }\n                })\n                .style(\"opacity\", 1)\n                .style(\"cursor\", 'pointer')\n                .on(\"mouseover\", mouseover)\n                .on(\"touchstart\", touchStart)\n                .on(\"click\", OpenTheUrl);\n\n            d3.select(\"#d3_container\")\n            .on(\"mouseleave\", mouseleave);\n        }\n\n        /** on mobile devices, touching the RadialTree prevents the ``click``\n         *  event and shows the URL like on ``mouseover`` event. Users can click\n         *  on the URL to visit the target page */\n        function touchStart(d) {\n            d3.event.preventDefault();\n            d3.event.stopPropagation();\n            mouseover(d);\n        }\n\n        function currentUrl(d) {\n            const anc = d.ancestors().reverse();\n            let url = \"\";\n            for (var i = 1; i < anc.length; i++) {\n                if (anc[i].data.name == 'end') {\n                    break;\n                }\n                url = url + '/' + anc[i].data.name;\n            }\n            return `${baseURL}/web/${GlobYear}0630${url}`;\n        }\n\n        function OpenTheUrl(d) {\n            window.location = currentUrl(d);\n        }\n\n        function mouseover(d) {\n            var sequenceArray = d.ancestors().reverse();\n            sequenceArray.shift();\n            var url = currentUrl(d);\n            UpdateBreadcrumbs(sequenceArray, url);\n            d3.selectAll(\"path\").style(\"opacity\", 0.3);\n            vis.selectAll(\"path\").filter(function(node) {\n                return (sequenceArray.indexOf(node) >= 0);\n            }).style(\"opacity\", 1);\n        }\n        \n        function mouseleave(d) {\n            element.querySelector(\".sequence\").innerHTML = \"\";\n            d3.selectAll(\"path\").on(\"mouseover\", null);\n            d3.selectAll(\"path\").transition().style(\"opacity\", 1).on(\"end\", function() {\n                d3.select(this).on(\"mouseover\", mouseover);\n            });\n        }\n\n        function UpdateBreadcrumbs(nodeArray, url) {\n            var text = \"\";\n            var symb = document.createElement('span');\n            symb.setAttribute('class', 'symb');\n            symb.innerHTML = \"/\";\n            for (var i = 0; i < nodeArray.length; i++) {\n                if (i == 0) {\n                    text = \" \" + nodeArray[i].data.name;\n                } else {\n                    text = text + symb.innerHTML + nodeArray[i].data.name;\n                }\n            }\n            text = decodeURIComponent(text);\n            element.querySelector(\".sequence\").innerHTML = `<a href=\"${url}\">${text}</a>`;\n        }\n\n        function BuildHierarchy(csv) {\n            csv.sort(function(a, b) {\n                return a[0].length - b[0].length || a[0].localeCompare(b[0]);\n            });\n            var real_urls = {};\n            real_urls[option.url] = 1;\n            if (option.url.slice(-1) != '/') {\n                real_urls[option.url + '/'] = 1;\n            }\n            for (var i = 0, length = csv.length; i < length; i++) {\n                var key = String(csv[i][0]).trim().replace(\":80/\", \"/\");\n                real_urls[key] = 1;\n                if (key.slice(-1) != '/') {\n                    real_urls[key + '/'] = 1;\n                }\n            }\n\n            var DELIMITER = '|';\n\n            function FilterRealUrl(url) {\n                var parts = url.trim().split(\"/\");\n                var delimiter_index = [];\n                for (var i = 1; i < parts.length; i++) {\n                    var potentialUrl = parts.slice(0, i).join(\"/\");\n                    if (potentialUrl in real_urls === false && i > 0) {\n                        var pos = parts.slice(0, i).join('/').length;\n                        delimiter_index.push(pos);\n                    }\n                }\n                if (delimiter_index.length > 0) {\n                    var result_url = url;\n                    for (var j = 1; j < delimiter_index.length; j++) {\n                        var index = delimiter_index[j];\n                        result_url = result_url.substr(0, index) + DELIMITER + result_url.substr(index + 1);\n                    }\n                    return result_url;\n                }\n                return url;\n            }\n            var root = { name: \"root\", children: [] };\n            for (var i = 0; i < length; i++) {\n                var sequence = FilterRealUrl(csv[i][0]);\n                var size = +csv[i][1];\n                if (isNaN(size)) {\n                    continue;\n                }\n                var parts = sequence.split(\"/\");\n                parts = parts.map(function(s) { return s.replace(/\\|/g, '/'); });\n                var currentNode = root;\n                for (var j = 0; j < parts.length; j++) {\n                    var children = currentNode.children;\n                    var nodeName = parts[j];\n                    var childNode;\n                    if (j + 1 < parts.length) {\n                        var foundChild = false;\n                        for (var k = 0; k < children.length; k++) {\n                            if (children[k].name == nodeName) {\n                                childNode = children[k];\n                                foundChild = true;\n                                break;\n                            }\n                        }\n                        if (!foundChild) {\n                            childNode = { name: nodeName, children: [] };\n                            children.push(childNode);\n                        }\n                        currentNode = childNode;\n                    } else {\n                        childNode = { name: nodeName, size: size };\n                        children.push(childNode);\n                    }\n                }\n            }\n            return root;\n        }\n    }\n\n    function MakeNewText(n, yearData){\n        var text = \"\";\n        var x = 2;\n        if (yearData[n].length == 2) {\n            x = 1;\n        }\n        for (var i = x; i < yearData[n].length; i++) {\n            if (i != (yearData[n].length - 1)) {\n                text = text + yearData[n][i] + \" ,1\" + \"\\n\";\n            } else {\n                text = text + yearData[n][i] + \" ,1\";\n            }\n        }\n        return text;\n    }\n}\n"],"names":["RadialTree","element","cdx_data","option","GlobYear","baseURL","indicatorImg","url","success","err","allYears","yearData","querySelector","style","display","Init","container","content","document","createElement","setAttribute","divBtn","sequence","chart","indicator","appendChild","GetData","response","cb","regexHTTP","regexHTTPS","regexLast","replace","length","yearUrl","i","match","trim","push","ret","year","concat","years","j","includes","substring","split","join","all_years","map","CreateYearButtons","forEach","btn","innerHTML","onclick","evt","target","classList","remove","add","id","num","indexOf","text","MakeNewText","click","DrawChart","width","offsetWidth","height","radius","Math","min","colors","d3","vis","append","attr","partition","size","PI","arc","startAngle","d","x0","endAngle","x1","innerRadius","sqrt","y0","outerRadius","y1","csv","json","BuildHierarchy","CreateVisualization","root","sum","sort","a","b","value","nodes","descendants","path","data","selectAll","enter","depth","name","children","parent","on","mouseover","touchStart","OpenTheUrl","mouseleave","preventDefault","stopPropagation","currentUrl","anc","ancestors","reverse","location","sequenceArray","shift","filter","node","transition","UpdateBreadcrumbs","nodeArray","symb","decodeURIComponent","localeCompare","real_urls","slice","key","String","DELIMITER","FilterRealUrl","parts","delimiter_index","potentialUrl","pos","result_url","index","substr","isNaN","s","currentNode","nodeName","childNode","foundChild","k","n","x"],"mappings":"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"}