!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3")):"function"==typeof define&&define.amd?define(["exports","d3"],t):t(e.wb={},e.d3)}(this,function(e,t){"use strict";e.RadialTree=function(e,n){function r(e,n,r,a){var i=e.querySelector(".div-btn");e.querySelector(".year-btn")||r.forEach(function(c,s){var u=document.createElement("button");u.setAttribute("class","year-btn"),u.setAttribute("id",r[s]),u.innerHTML=r[s],u.onclick=function(i){var c=i.target;e.querySelector(".active-btn")&&e.querySelector(".active-btn").classList.remove("active-btn"),c.classList.add("active-btn"),l=c.id;var s=function(e,t){var n="",r=2;2==t[e].length&&(r=1);for(var a=r;a<t[e].length;a++)n=a!=t[e].length-1?n+t[e][a]+" ,1\n":n+t[e][a]+" ,1";return n}(r.indexOf(c.id),a);!function(e,n,r){function a(e){for(var t=l,n=e.ancestors().reverse(),r="",a=1;a<n.length&&"end"!=n[a].data.name;a++)r=r+"/"+n[a].data.name;window.open(o+"/web/"+t+"0630"+r)}function i(n){var r=n.ancestors().reverse();r.shift(),function(t){var n="",r=document.createElement("span");r.setAttribute("class","symb"),r.innerHTML="/";for(var a=0;a<t.length;a++)n=0==a?" "+t[a].data.name:n+r.innerHTML+t[a].data.name;e.querySelector(".sequence").innerHTML=n}(r),t.selectAll("path").style("opacity",.3),f.selectAll("path").filter(function(e){return r.indexOf(e)>=0}).style("opacity",1)}function c(n){e.querySelector(".sequence").innerHTML="",t.selectAll("path").on("mouseover",null),t.selectAll("path").transition().style("opacity",1).on("end",function(){t.select(this).on("mouseover",i)})}e.querySelector(".sequence").innerHTML="",e.querySelector("#chart").innerHTML="";var s=e.querySelector("#chart").offsetWidth,u=s,d=Math.min(s,u)/2,p=t.scaleOrdinal(t.schemeCategory20b),f=t.select("#chart").append("svg:svg").attr("width",s).attr("height",u).append("svg:g").attr("id","d3_container").attr("transform","translate("+s/2+","+u/2+")"),h=t.partition().size([2*Math.PI,d*d]),v=t.arc().startAngle(function(e){return e.x0}).endAngle(function(e){return e.x1}).innerRadius(function(e){return Math.sqrt(e.y0)}).outerRadius(function(e){return Math.sqrt(e.y1)});!function(e){f.append("svg:circle").attr("r",d).style("opacity",0);var n=t.hierarchy(e).sum(function(e){return e.size}).sort(function(e,t){return t.value-e.value}),r=h(n).descendants();f.data([e]).selectAll("path").data(r).enter().append("svg:path").attr("display",function(e){return e.depth?null:"none"}).attr("d",v).attr("fill-rule","evenodd").style("fill",function(e){return"end"==e.data.name?"#000000":p((e.children?e:e.parent).data.name)}).style("opacity",1).style("cursor","pointer").on("mouseover",i).on("click",a),t.select("#d3_container").on("mouseleave",c)}(function(e){function t(e){for(var t=e.trim().split("/"),n=[],a=1;a<t.length;a++){var i=t.slice(0,a).join("/");if(i in r==0&&a>0){var l=t.slice(0,a).join("/").length;n.push(l)}}if(n.length>0){for(var c=e,s=1;s<n.length;s++){var u=n[s];c=c.substr(0,u)+o+c.substr(u+1)}return c}return e}e.sort(function(e,t){return e[0].length-t[0].length||e[0].localeCompare(t[0])});var r={};r[n.url]=1,"/"!=n.url.slice(-1)&&(r[n.url+"/"]=1);for(var a=0,i=e.length;a<i;a++){var l=String(e[a][0]).trim().replace(":80/","/");r[l]=1,"/"!=l.slice(-1)&&(r[l+"/"]=1)}for(var o="|",c={name:"root",children:[]},a=0;a<i;a++){var s=t(e[a][0]),u=+e[a][1];if(!isNaN(u)){var d=s.split("/");d=d.map(function(e){return e.replace(/\|/g,"/")});for(var p=c,f=0;f<d.length;f++){var h,v=p.children,m=d[f];if(f+1<d.length){for(var g=!1,y=0;y<v.length;y++)if(v[y].name==m){h=v[y],g=!0;break}g||(h={name:m,children:[]},v.push(h)),p=h}else h={name:m,size:u},v.push(h)}}}return c}(t.csvParseRows(r)))}(e,n,s)},i.appendChild(u),s==r.length-1&&u.click()})}var a,i,l=0,o="https://web.archive.org";void 0!==n.baseURL&&(o=n.baseURL),n.limit&&(a=n.limit),n.indicatorImg&&(i=n.indicatorImg),n.url&&(function(e){var t=document.createElement("div");t.setAttribute("class","rt-content");var n=document.createElement("div");n.setAttribute("class","div-btn");var r=document.createElement("p");r.setAttribute("class","sequence");var a=document.createElement("div");if(a.setAttribute("id","chart"),i){var l=document.createElement("img");l.setAttribute("src",i),l.setAttribute("class","rt-indicator"),a.appendChild(l)}t.appendChild(n),t.appendChild(r),t.appendChild(a),t.style.display="block",e.appendChild(t)}(e),function(e,t){e.replace(/http:\/\//,""),e.replace(/https:\/\//,""),e.replace(/\/$/,"");var n=o+"/web/timemap/json?url="+e+"/&fl=timestamp:4,original&matchType=prefix&filter=statuscode:200&filter=mimetype:text/html&collapse=urlkey&collapse=timestamp:4";a&&(n+="&limit="+a);var r=new XMLHttpRequest;r.open("GET",n,!0),r.onerror=function(){t(!1,"An error occured. Please refresh the page and try again")},r.ontimeout=function(){t(!1,"Timeout, Please refresh the page and try again")},r.onload=function(){var e=JSON.parse(r.responseText);0==e.length&&t(!0,[]);for(var n=[],a=1;a<e.length;a++)e[a][1].match(/jpg|pdf|png|form|gif/)||(e[a][1]=e[a][1].trim().replace(":80/","/"),e[a][0]in n?n[e[a][0]].push(e[a][1]):n[e[a][0]]=[e[a][1]]);var i=[];for(var l in n)i.push([l].concat(n[l]));var o=function(){for(var e=0;e<i.length;e++)for(var t=1;t<i[e].length;t++){var n;i[e][t].includes("http")?n=i[e][t].substring(7):i[e][t].includes("https")&&(n=i[e][t].substring(8)),n.includes("//")&&(n=n.split("//").join("/")),n=n.split("/").join("/"),i[e][t]=n}return i}(),c=o.map(function(e){if(e.length>1)return e[0]});t(!0,null,c,o)},r.send()}(n.url,function(t,a,l,o){i&&(e.querySelector(".rt-indicator").style.display="none"),t&&r(e,n,l,o)}))},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=radial-tree.umd.js.map
